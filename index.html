<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>סביבת פיתוח - בדיקת VCards</title>
    <style>
        body { font-family: -apple-system, system-ui, sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #1c1e21; }
        .contact-row { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; border-bottom: 1px solid #eee; 
        }
        .contact-info { display: flex; flex-direction: column; }
        .name { font-weight: bold; font-size: 1.1em; }
        .phone { color: #65676b; font-size: 0.9em; }
        .download-btn {
            background: #007bff; color: white; padding: 8px 16px;
            border-radius: 20px; text-decoration: none; font-size: 14px;
        }
        .download-btn:hover { background: #0056b3; }
    </style>
</head>
<body>

<div class="container">
    <h1>רשימת אנשי קשר מ-Alfon</h1>
    <div id="list">טוען נתונים מה-Repo הראשי...</div>
</div>

<script>
    // הכתובות המלאות ל-Repo של alfon
    const BASE_ALFON_URL = 'https://dekelcom.github.io/alfon';
    
    async function loadContacts() {
        const listDiv = document.getElementById('list');
        try {
            // 1. מושך את רשימת אנשי הקשר מה-JSON ב-Alfon
            const response = await fetch(`${BASE_ALFON_URL}/contacts.json`);
            if (!response.ok) throw new Error('לא מצליח למשוך את ה-JSON');
            
            const contacts = await response.json();
            
            // 2. בונה את הרשימה עם קישורים ישירים לקבצי ה-VCF
            listDiv.innerHTML = contacts.map(c => {
                // ניקוי המספר לצורך שם הקובץ (למשל 972502001754)
                const fileId = c.mobileE164 ? c.mobileE164.replace('+', '') : '';
                const vcfUrl = `${BASE_ALFON_URL}/vcards/${fileId}.vcf`;
                
                return `
                    <div class="contact-row">
                        <div class="contact-info">
                            <span class="name">${c.name}</span>
                            <span class="phone">${c.mobileE164 || c.mobile}</span>
                        </div>
                        <a href="${vcfUrl}" class="download-btn">הורד VCard</a>
                    </div>
                `;
            }).join('');
            
        } catch (error) {
            listDiv.innerHTML = `<p style="color:red">שגיאה: ${error.message}<br>וודא שה-Repo ב-alfon פורסם ב-GitHub Pages.</p>`;
        }
    }

    loadContacts();
</script>

</body>
</html>
